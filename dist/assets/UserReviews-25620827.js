import{r as m,A as w,j as e,a as u,b as E}from"./index-962aa7a8.js";import{u as j,E as f,M as g,B as i}from"./http-hook-a222d301.js";import{C as v}from"./Card-b927284e.js";const C=s=>{const{isLoading:t,error:c,clearError:h,sendRequest:l}=j(),r=m.useContext(w),[o,n]=m.useState(!1),d=()=>{n(!0)},a=()=>{n(!1)},x=async()=>{n(!1);try{await l(`https://review-back.onrender.com/api/places/${s.id}`,"DELETE",null,{Authorization:"Bearer "+r.token}),s.onDelete(s.id)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(f,{error:c,onClear:h}),e.jsx(g,{show:o,onCancel:a,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:e.jsxs(e.Fragment,{children:[e.jsx(i,{inverse:!0,onClick:a,children:"CANCEL"}),e.jsx(i,{danger:!0,onClick:x,children:"DELETE"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete this review? Please note that it cant be undone thereafter"})}),e.jsx("li",{className:"place-item",children:e.jsxs(v,{className:"place-item__content",children:[t&&e.jsx(u,{asOverlay:!0}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`https://review-back.onrender.com/${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsxs("div",{className:"place-item__rating",children:[e.jsx("h3",{className:"place-item__rating-text",children:s.address}),e.jsx("span",{style:{fontSize:"1em",color:"tomato"},children:e.jsx("i",{className:"fa-solid fa-star"})})]}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[r.userId===s.creatorId&&e.jsx(i,{to:`/places/${s.id}`,children:"EDIT"}),r.userId===s.creatorId&&e.jsx(i,{danger:!0,onClick:d,children:"DELETE"})]})]})})]})};const D=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(v,{children:[e.jsx("h2",{children:"No reviews found. Maybe create one?"}),e.jsx(i,{to:"/places/new",children:"Share Review"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(t=>e.jsx(C,{id:t.id,image:t.image,title:t.title,description:t.description,address:t.address,creatorId:t.creator,onDelete:s.onDeletePlace},t.id))}),y=()=>{const[s,t]=m.useState(),{isLoading:c,error:h,sendRequest:l,clearError:r}=j(),o=E().userId;m.useEffect(()=>{(async()=>{try{const a=await l(`https://review-back.onrender.com/api/places/user/${o}`);t(a.places)}catch{}})()},[l,o]);const n=d=>{t(a=>a.filter(x=>x.id!==d))};return e.jsxs(e.Fragment,{children:[e.jsx(f,{error:h,onClear:r}),c&&e.jsx("div",{className:"center",children:e.jsx(u,{})}),!c&&s&&e.jsx(D,{items:s,onDeletePlace:n})]})};export{y as default};

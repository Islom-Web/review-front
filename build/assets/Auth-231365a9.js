import{r as d,A as g,j as e,a as j}from"./index-6f7faf75.js";import{C as w}from"./Card-f52b186a.js";import{u as T,I as n,V as L,c as S,a as A}from"./form-hook-0926a5de.js";import{u as N,E as O,B as m}from"./http-hook-88248e19.js";import{I as V}from"./ImageUpload-22d88d96.js";const b=()=>{const o=d.useContext(g),[t,c]=d.useState(!0),{isLoading:x,error:I,sendRequest:l,clearError:h}=N(),[a,r,p]=T({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),v=()=>{t?p({...a.inputs,name:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1):p({...a.inputs,name:void 0,image:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),c(i=>!i)},f=async i=>{if(i.preventDefault(),t)try{const s=await l("http://localhost:5000/api/users/login","POST",JSON.stringify({email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.token)}catch{}else try{const s=new FormData;s.append("email",a.inputs.email.value),s.append("name",a.inputs.name.value),s.append("password",a.inputs.password.value),s.append("image",a.inputs.image.value);const u=await l("http://localhost:5000/api/users/signup","POST",s);o.login(u.userId,u.token)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(O,{error:I,onClear:h}),e.jsxs(w,{className:"authentication",children:[x&&e.jsx(j,{asOverlay:!0}),e.jsxs("h2",{children:[t?"LOGIN":"SIGN UP"," required"]}),e.jsx("hr",{}),e.jsxs("form",{onSubmit:f,children:[!t&&e.jsx(n,{element:"input",id:"name",label:"Your Name",type:"text",validators:[L],errorText:"Please enter a name",onInput:r}),!t&&e.jsx(V,{errorText:"Please provide an image",onInput:r,center:!0,id:"image"}),e.jsx(n,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[S()],errorText:"Please enter a valid email",onInput:r}),e.jsx(n,{element:"input",id:"password",type:"password",label:"Password",validators:[A(6)],errorText:"Please enter a valid password, at least 6 characters",onInput:r}),e.jsx(m,{type:"submit",disabled:!a.isValid,children:t?"LOGIN":"SIGN UP"})]}),e.jsxs(m,{inverse:!0,onClick:v,children:["SWITCH TO ",t?"SIGN UP":"LOGIN"]})]})]})};export{b as default};

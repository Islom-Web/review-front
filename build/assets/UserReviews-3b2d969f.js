import{r as h,A as g,j as e,a as u,b as v}from"./index-6f7faf75.js";import{u as j,E as f,M as w,B as i}from"./http-hook-88248e19.js";import{C as E}from"./Card-f52b186a.js";const C=s=>{const{isLoading:t,error:l,clearError:m,sendRequest:c}=j(),r=h.useContext(g),[o,n]=h.useState(!1),d=()=>{n(!0)},a=()=>{n(!1)},x=async()=>{n(!1);try{await c(`http://localhost:5000/api/places/${s.id}`,"DELETE",null,{Authorization:"Bearer "+r.token}),s.onDelete(s.id)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(f,{error:l,onClear:m}),e.jsx(w,{show:o,onCancel:a,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:e.jsxs(e.Fragment,{children:[e.jsx(i,{inverse:!0,onClick:a,children:"CANCEL"}),e.jsx(i,{danger:!0,onClick:x,children:"DELETE"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete this review? Please note that it cant be undone thereafter"})}),e.jsx("li",{className:"place-item",children:e.jsxs(E,{className:"place-item__content",children:[t&&e.jsx(u,{asOverlay:!0}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`http://localhost:5000/${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsxs("div",{className:"place-item__rating",children:[e.jsx("h3",{className:"place-item__rating-text",children:s.address}),e.jsx("span",{style:{fontSize:"1em",color:"tomato"},children:e.jsx("i",{className:"fa-solid fa-star"})})]}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[r.userId===s.creatorId&&e.jsx(i,{to:`/places/${s.id}`,children:"EDIT"}),r.userId===s.creatorId&&e.jsx(i,{danger:!0,onClick:d,children:"DELETE"})]})]})})]})};const D=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(E,{children:[e.jsx("h2",{children:"No reviews found. Maybe create one?"}),e.jsx(i,{to:"/places/new",children:"Share Review"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(t=>e.jsx(C,{id:t.id,image:t.image,title:t.title,description:t.description,address:t.address,creatorId:t.creator,onDelete:s.onDeletePlace},t.id))}),y=()=>{const[s,t]=h.useState(),{isLoading:l,error:m,sendRequest:c,clearError:r}=j(),o=v().userId;h.useEffect(()=>{(async()=>{try{const a=await c(`http://localhost:5000/api/places/user/${o}`);t(a.places)}catch{}})()},[c,o]);const n=d=>{t(a=>a.filter(x=>x.id!==d))};return e.jsxs(e.Fragment,{children:[e.jsx(f,{error:m,onClear:r}),l&&e.jsx("div",{className:"center",children:e.jsx(u,{})}),!l&&s&&e.jsx(D,{items:s,onDeletePlace:n})]})};export{y as default};
